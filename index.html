<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MIT Dorm & Grad Housing Map</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      background: #f5f5f7;
      color: #111827;
      display: flex;
      height: 100vh;
      max-height: 100vh;
      overflow: hidden;
    }

    .sidebar {
      width: 340px;
      padding: 14px;
      background: #ffffff;
      border-right: 1px solid #e5e7eb;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .sidebar h1 {
      font-size: 18px;
      font-weight: 600;
    }

    .sidebar p.subtitle {
      font-size: 11px;
      color: #6b7280;
      margin-bottom: 6px;
    }

    .locations-list {
      display: flex;
      flex-direction: column;
      gap: 5px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .loc-btn {
      padding: 7px 9px;
      border-radius: 9px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      font-size: 11px;
      text-align: left;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .loc-btn strong {
      display: block;
      font-size: 11px;
      margin-bottom: 1px;
    }

    .loc-btn span {
      font-size: 10px;
      color: #6b7280;
    }

    .loc-btn:hover {
      background: #eef2ff;
      border-color: #4f46e5;
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(15,23,42,0.08);
    }

    .loc-btn.active {
      background: #4f46e5;
      color: #ffffff;
      border-color: #4338ca;
      box-shadow: 0 4px 12px rgba(79,70,229,0.35);
    }

    #map {
      flex: 1;
      position: relative;
    }

    #map-inner {
      height: 100%;
      width: 100%;
    }

    .info-panel {
      position: fixed;  /* instead of absolute */
      bottom: 14px;
      left: 360px; /* shift to appear next to sidebar */
      max-width: 280px;
      padding: 9px 11px;
      background: rgba(17,24,39,0.96);
      color: #f9fafb;
      border-radius: 14px;
      font-size: 10px;
      box-shadow: 0 10px 26px rgba(15,23,42,0.4);
      backdrop-filter: blur(8px);
      z-index: 9999;
    }


    .info-panel h2 {
      font-size: 12px;
      margin-bottom: 2px;
      font-weight: 600;
    }

    .info-panel p {
      font-size: 10px;
      line-height: 1.4;
      color: #d1d5db;
      margin-bottom: 6px;
    }

    .info-btn {
      padding: 5px 8px;
      border-radius: 999px;
      border: none;
      font-size: 10px;
      cursor: pointer;
      background: #4f46e5;
      color: #f9fafb;
      box-shadow: 0 4px 10px rgba(79,70,229,0.5);
      transition: background 0.15s ease, transform 0.15s ease, box-shadow 0.15s ease;
    }

    .info-btn:hover {
      background: #4338ca;
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(79,70,229,0.6);
    }

    @media (max-width: 800px) {
      body {
        flex-direction: column;
        height: 100vh;
      }
      .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #e5e7eb;
        max-height: 40vh;
      }
      #map {
        height: 60vh;
      }
      .info-panel {
        max-width: 60%;
      }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h1>MIT Housing Map</h1>
    <p class="subtitle">
      Click a dorm to zoom and open its Google Classroom with more information.
    </p>
    <div class="locations-list" id="locationsList"></div>
  </div>

  <div id="map">
    <div id="map-inner"></div>
  </div>

  <div class="info-panel" id="infoPanel">
    <h2>Welcome</h2>
    <p>Select a residence from the list or map to open its info Classroom.</p>
  </div>


  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    // Map centered on MIT
    const map = L.map("map-inner").setView([42.3592, -71.0930], 15.6);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "&copy; OpenStreetMap contributors"
    }).addTo(map);

    const infoPanel = document.getElementById("infoPanel");
    const locationsList = document.getElementById("locationsList");
    const markersById = {};
    const buttonsById = {};

    // Helper: replace these classroomUrl values with your real links.
    const locations = [
      {
        id: "70amherst",
        code: "E2",
        name: "70 Amherst St",
        short: "Grad residence near east campus.",
        lat: 42.359917,
        lng: -71.087295,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMzA5NTYy/details"
      },
      {
        id: "ashdown",
        code: "NW35",
        name: "Ashdown House",
        short: "Grad residence at Albany St.",
        lat: 42.358704,
        lng: -71.100677,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMjQ3Mzc4/details"
      },
      {
        id: "baker",
        code: "W7",
        name: "Baker House",
        short: "Undergrad dorm on Memorial Dr.",
        lat: 42.356658,
        lng: -71.096164,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMjM4NzQz/details"
      },
      {
        id: "burtonconner",
        code: "W51",
        name: "Burton-Conner",
        short: "Undergrad suite-style on river.",
        lat: 42.355948,
        lng: -71.098218,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMDc5MjIw/details"
      },
      {
        id: "eastcampus",
        code: "62/64",
        name: "East Campus",
        short: "Undergrad dorm next to main campus.",
        lat: 42.360386,
        lng: -71.088126,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxNDAyNjMw/details"
      },
      {
        id: "edgerton",
        code: "NW10",
        name: "Edgerton House",
        short: "Grad residence on Albany St.",
        lat: 42.360326,
        lng: -71.098601,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMTQ4MTIy/details"
      },
      {
        id: "macgregor",
        code: "W61",
        name: "MacGregor House",
        short: "Undergrad tower-style on river.",
        lat: 42.355492,
        lng: -71.099866,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMjQyMzY1/details"
      },
      {
        id: "maseeh",
        code: "W1",
        name: "Maseeh Hall",
        short: "Undergrad dorm at Mass Ave bridge.",
        lat: 42.357628,
        lng: -71.093734,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgwOTIwNjIy/details"
      },
      {
        id: "mccormick",
        code: "W4",
        name: "McCormick Hall",
        short: "Undergrad residence on Memorial Dr.",
        lat: 42.357175,
        lng: -71.094146,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMjc3NjYz/details"
      },
      {
        id: "newhouse",
        code: "W70",
        name: "New House",
        short: "Undergrad cultural & theme communities.",
        lat: 42.355167,
        lng: -71.100698,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgxMjUyMDM0/details"
      },
      {
        id: "newvassar",
        code: "W46",
        name: "New Vassar",
        short: "Modern undergrad dorm on Vassar St.",
        lat: 42.3588826,
        lng: -71.0979966,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgxMDg3NDc2/details"
      },
      {
        id: "nexthouse",
        code: "W71",
        name: "Next House",
        short: "Undergrad west campus community.",
        lat: 42.3547177,
        lng: -71.1020805,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgwODY4Mzc4/details"
      },
      {
        id: "random",
        code: "NW61",
        name: "Random Hall",
        short: "Small, close-knit undergrad dorm.",
        lat: 42.361855,
        lng: -71.0982773,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgwNDYzOTQ1/details"
      },
      {
        id: "sidneypacific",
        code: "NW86",
        name: "Sidney-Pacific",
        short: "Large grad community on Pacific St.",
        lat: 42.3597437,
        lng: -71.1028456,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgxMDQ2Njc1/details"
      },
      {
        id: "simmons",
        code: "W79",
        name: "Simmons Hall",
        short: "Undergrad \"sponge\" on Vassar St.",
        lat: 42.3571235,
        lng: -71.1015013,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMTk4NzE1/details"
      },
      {
        id: "site4",
        code: "E37",
        name: "Site 4 (Grad Tower)",
        short: "Grad tower at Kendall / Hayward St.",
        lat: 42.3618261,
        lng: -71.0855044,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgwOTA1NjQz/details"
      },
      {
        id: "tang",
        code: "W84",
        name: "Tang Hall",
        short: "Grad residence at west end of campus.",
        lat: 42.3543528,
        lng: -71.1034787,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1Nzc5OTA0Mjk0/details"
      },
      {
        id: "warehouse",
        code: "NW30",
        name: "The Warehouse",
        short: "Grad residence on Albany St.",
        lat: 42.358693,
        lng: -71.1000344,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgxMjU3NzI0/details"
      },
      {
        id: "westgate",
        code: "W85",
        name: "Westgate Apartments",
        short: "Grad family housing on Memorial Dr.",
        lat: 42.3550023,
        lng: -71.1032611,
        zoom: 18,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1NzgwODg3MTMw/details"
      }
    ];

    // Build buttons and markers
    locations.forEach((loc) => {
      const marker = L.marker([loc.lat, loc.lng]).addTo(map);
      marker.on("click", () => focusLocation(loc.id));
      markersById[loc.id] = marker;

      const btn = document.createElement("button");
      btn.className = "loc-btn";
      btn.innerHTML = `
        <strong>${loc.name}</strong>
        <span>${loc.short}</span>
      `;
      btn.addEventListener("click", () => focusLocation(loc.id));
      locationsList.appendChild(btn);
      buttonsById[loc.id] = btn;
    });

    function focusLocation(id) {
      const loc = locations.find((l) => l.id === id);
      if (!loc) return;

      // Highlight active button
      Object.values(buttonsById).forEach((b) => b.classList.remove("active"));
      if (buttonsById[id]) buttonsById[id].classList.add("active");

      // Zoom to residence
      map.flyTo([loc.lat, loc.lng], loc.zoom || 18, { duration: 0.6 });

      // Update info panel with Classroom button
      infoPanel.innerHTML = `
        <h2>${loc.name}</h2>
        <p>Click below to open the Google Classroom page with more information for ${loc.name}.</p>
        <button class="info-btn" id="open-${loc.id}">
          Open Google Classroom
        </button>
      `;

      const openBtn = document.getElementById(`open-${loc.id}`);
      if (openBtn && loc.classroomUrl) {
        openBtn.addEventListener("click", () => {
          window.open(loc.classroomUrl, "_blank", "noopener");
        });
      }

      // Optional popup on marker
      if (markersById[id]) {
        markersById[id]
          .bindPopup(`<b>${loc.name}</b><br>${loc.short}`)
          .openPopup();
      }
    }
  </script>
</body>
</html>
